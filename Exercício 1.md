# Exercício 1 (Linguagem R)
##### Num fluxo de caixa aleatório e sem saídas de 100 períodos, todos os valores foram trazidos a valores do mês 1, considerando custos de oportunidade de 0,01 a 0,1. Depois, todos os VPL e as entradas foram somados. A seguir estão o código e as saídas por ele geradas.
#
### Código:
```r
# Função para calcular o VPL trazendo todos os fluxos para o valor presente no mês 1:
calcular_vpl_mensal <- function(fluxos, taxa) {
  vpl_total <- sum(fluxos / ((1 + taxa)^(1:length(fluxos))))
  return(vpl_total)
}

# Gera um fluxo de caixa com 100 valores (média 5000, desvio padrão 1000):
set.seed(123)
fluxos <- rnorm(100, mean = 5000, sd = 1000)

# Define taxas de desconto de 0.01 a 0.10:
taxas <- seq(0.01, 0.10, by = 0.01)

# Cria uma matriz para armazenar os resultados:
resultados <- matrix(nrow = length(fluxos), ncol = length(taxas) + 1)
colnames(resultados) <- c("Fluxo", paste0("VPL ", seq(1, 10), "%"))

# Calcula o VPL para cada fluxo e taxa de desconto:
for (i in 1:length(fluxos)) {
  resultados[i, 1] <- fluxos[i]  # Armazena o fluxo na primeira coluna
  for (j in 1:length(taxas)) {
    # Calcula o VPL de cada fluxo para o valor presente no mês 1:
    resultados[i, j + 1] <- fluxos[i] / ((1 + taxas[j])^i)
  }
}

# Adiciona os somatórios dos fluxos e dos VPLs (trazidos para o mês 1):
soma_fluxos <- sum(resultados[, 1])
soma_vpls <- colSums(resultados[, -1])

# Função para formatar os valores com o mesmo número de casas decimais, sem espaçamento extra:
formatar_valores <- function(fluxo, vpls) {
  sprintf("%10.2f (%7.2f; %8.2f; %8.2f; %8.2f; %8.2f; %8.2f; %8.2f; %8.2f; %8.2f; %8.2f)",
          fluxo, vpls[1], vpls[2], vpls[3], vpls[4], vpls[5], vpls[6], vpls[7], vpls[8], vpls[9], vpls[10])
}

# Cria um data frame para exibir a tabela de fluxos, com formatação fixa:
df_fluxos <- data.frame(Mês = 1:100, Fluxo_VPL = apply(resultados, 1, function(x) {
  formatar_valores(x[1], x[2:11])
}))

# Cria uma tabela separada para os somatórios, também com formatação fixa:
df_somatorios <- data.frame(Mês = "Todos", Fluxo_VPL = formatar_valores(soma_fluxos, soma_vpls))

# Exibe as tabelas separadamente:
library(knitr)

# Tabela de Fluxos:
kable(df_fluxos, 
      align = "c", 
      col.names = c("Mês", "Fluxo (VPL 1%; VPL 2%; VPL 3%; VPL 4%; VPL 5%; VPL 6%; VPL 7%; VPL 8%; VPL 9%; VPL 10%)"))

# Tabela de Somatórios:
kable(df_somatorios, 
      align = "c", 
      col.names = c("Mês", "Somatório (VPL 1%; VPL 2%; VPL 3%; VPL 4%; VPL 5%; VPL 6%; VPL 7%; VPL 8%; VPL 9%; VPL 10%)"))
```
#
### Resultados:
#### Fluxos de caixa
```python
| Mês |           Fluxo (VPL 1%; VPL 2%; VPL 3%; VPL 4%; VPL 5%; VPL 6%; VPL 7%; VPL 8%; VPL 9%; VPL 10%)           |
|:---:|:-----------------------------------------------------------------------------------------------------------:|
|  1  | 4439.52 (4395.57;  4352.47;  4310.22;  4268.77;  4228.12;  4188.23;  4149.09;  4110.67;  4072.96;  4035.93) |
|  2  | 4769.82 (4675.84;  4584.60;  4496.02;  4409.97;  4326.37;  4245.13;  4166.15;  4089.35;  4014.66;  3942.00) |
|  3  | 6558.71 (6365.82;  6180.42;  6002.15;  5830.67;  5665.66;  5506.82;  5353.86;  5206.51;  5064.53;  4927.65) |
|  4  | 5070.51 (4872.66;  4684.37;  4505.08;  4334.29;  4171.52;  4016.32;  3868.27;  3726.98;  3592.08;  3463.23) |
|  5  | 5129.29 (4880.34;  4645.75;  4424.57;  4215.90;  4018.93;  3832.90;  3657.11;  3490.91;  3333.69;  3184.88) |
|  6  | 6715.06 (6325.89;  5962.79;  5623.76;  5307.01;  5010.88;  4733.86;  4474.53;  4231.63;  4003.97;  3790.48) |
|  7  | 5460.92 (5093.50;  4754.06;  4440.22;  4149.85;  3880.97;  3631.82;  3400.78;  3186.39;  2987.31;  2802.31) |
|  8  | 3734.94 (3449.15;  3187.73;  2948.40;  2729.08;  2527.95;  2343.35;  2173.77;  2017.87;  1874.44;  1742.38) |
|  9  | 4313.15 (3943.68;  3609.05;  3305.67;  3030.36;  2780.29;  2552.95;  2346.07;  2157.65;  1985.89;  1829.20) |
| 10  | 4554.34 (4122.98;  3736.14;  3388.86;  3076.75;  2795.97;  2543.12;  2315.19;  2109.54;  1923.80;  1755.89) |
| 11  | 6224.08 (5578.79;  5005.80;  4496.41;  4043.04;  3639.09;  3278.77;  2957.02;  2669.40;  2412.04;  2181.50) |
| 12  | 5359.81 (4756.56;  4226.18;  3759.27;  3347.72;  2984.54;  2663.66;  2379.82;  2128.46;  1905.60;  1707.80) |
| 13  | 5400.77 (4745.46;  4174.97;  3677.66;  3243.56;  2864.14;  2532.09;  2241.13;  1985.85;  1761.62;  1564.41) |
| 14  | 5110.68 (4446.10;  3873.26;  3378.76;  2951.29;  2581.24;  2260.46;  1982.01;  1739.99;  1529.35;  1345.80) |
| 15  | 4444.16 (3827.97;  3302.08;  2852.54;  2467.68;  2137.72;  1854.39;  1610.77;  1400.98;  1220.09;  1063.90) |
| 16  | 6786.91 (5788.02;  4943.90;  4229.38;  3623.59;  3109.16;  2671.64;  2298.96;  1981.04;  1709.42;  1477.03) |
| 17  | 5497.85 (4642.26;  3926.36;  3326.29;  2822.45;  2398.69;  2041.71;  1740.48;  1485.90;  1270.41;  1087.72) |
| 18  | 3033.38 (2535.96;  2123.85;  1781.79;  1497.36;  1260.43;  1062.73;   897.47;   759.10;   643.06;   545.58) |
| 19  | 5701.36 (4719.24;  3913.59;  3251.40;  2706.11;  2256.22;  1884.37;  1576.47;  1321.07;  1108.85;   932.22) |
| 20  | 4527.21 (3710.25;  3046.68;  2506.61;  2066.16;  1706.26;  1411.61;  1169.92;   971.30;   807.79;   672.94) |
| 21  | 3932.18 (3190.69;  2594.35;  2113.74;  1725.57;  1411.42;  1156.67;   949.67;   781.15;   643.69;   531.36) |
| 22  | 4782.03 (3841.86;  3093.20;  2495.70;  2017.80;  1634.73;  1327.04;  1079.37;   879.61;   718.17;   587.45) |
| 23  | 3974.00 (3161.08;  2520.13;  2013.59;  1612.35;  1293.82;  1040.38;   838.30;   676.83;   547.54;   443.81) |
| 24  | 4271.11 (3363.78;  2655.44;  2101.10;  1666.25;  1324.33;  1054.87;   842.03;   673.55;   539.89;   433.63) |
| 25  | 4374.96 (3411.46;  2666.67;  2089.51;  1641.12;  1291.94;  1019.36;   806.08;   638.82;   507.35;   403.79) |
| 26  | 3313.31 (2558.03;  1979.96;  1536.36;  1195.07;   931.84;   728.30;   570.54;   447.96;   352.51;   278.00) |
| 27  | 5837.79 (4462.43;  3420.14;  2628.11;  2024.64;  1563.64;  1210.57;   939.48;   730.81;   569.81;   445.29) |
| 28  | 5153.37 (3900.26;  2959.97;  2252.42;  1718.53;  1314.59;  1008.16;   775.08;   597.35;   461.48;   357.35) |
| 29  | 3861.86 (2893.86;  2174.66;  1638.77;  1238.31;   938.23;   712.73;   542.83;   414.48;   317.27;   243.45) |
| 30  | 6253.81 (4639.85;  3452.55;  2576.49;  1928.17;  1446.99;  1088.85;   821.55;   621.49;   471.36;   358.40) |
| 31  | 5426.46 (3986.16;  2937.05;  2170.52;  1608.73;  1195.77;   891.32;   666.22;   499.32;   375.23;   282.71) |
| 32  | 4704.93 (3421.91;  2496.59;  1827.10;  1341.18;   987.41;   729.06;   539.85;   400.86;   298.47;   222.84) |
| 33  | 5895.13 (4245.10;  3066.81;  2222.62;  1615.82;  1178.27;   861.79;   632.16;   465.06;   343.10;   253.83) |
| 34  | 5878.13 (4190.95;  2998.01;  2151.66;  1549.19;  1118.93;   810.66;   589.10;   429.37;   313.86;   230.08) |
| 35  | 5821.58 (4109.54;  2910.95;  2068.89;  1475.28;  1055.40;   757.42;   545.27;   393.74;   285.18;   207.16) |
| 36  | 5688.64 (3975.93;  2788.70;  1962.77;  1386.14;   982.19;   698.23;   497.96;   356.25;   255.66;   184.02) |
| 37  | 5553.92 (3843.34;  2669.27;  1860.47;  1301.27;   913.26;   643.11;   454.36;   322.05;   228.99;   163.33) |
| 38  | 4938.09 (3383.35;  2326.76;  1606.00;  1112.48;   773.33;   539.43;   377.55;   265.13;   186.79;   132.02) |
| 39  | 4694.04 (3184.29;  2168.40;  1482.16;  1016.83;   700.11;   483.75;   335.41;   233.36;   162.90;   114.09) |
| 40  | 4619.53 (3102.72;  2092.14;  1416.15;   962.20;   656.18;   449.12;   308.49;   212.64;   147.07;   102.07) |
| 41  | 4305.29 (2863.03;  1911.59;  1281.38;   862.26;   582.43;   394.88;   268.70;   183.50;   125.75;    86.48) |
| 42  | 4792.08 (3155.20;  2086.01;  1384.72;   922.83;   617.41;   414.65;   279.52;   189.12;   128.41;    87.50) |
| 43  | 3734.60 (2434.59;  1593.81;  1047.72;   691.53;   458.25;   304.85;   203.58;   136.47;    91.81;    62.00) |
| 44  | 7168.96 (4627.17;  2999.50;  1952.62;  1276.41;   837.77;   552.07;   365.23;   242.56;   161.69;   108.19) |
| 45  | 6207.96 (3967.23;  2546.49;  1641.62;  1062.79;   690.92;   451.01;   295.58;   194.48;   128.46;    85.17) |
| 46  | 3876.89 (2453.02;  1559.11;   995.34;   638.19;   410.94;   265.71;   172.52;   112.46;    73.60;    48.35) |
| 47  | 4597.12 (2879.92;  1812.50;  1145.87;   727.64;   464.08;   297.24;   191.18;   123.47;    80.06;    52.12) |
| 48  | 4533.34 (2811.85;  1752.31;  1097.06;   689.95;   435.85;   276.53;   176.20;   112.74;    72.43;    46.73) |
| 49  | 5779.97 (3549.59;  2190.37;  1358.00;   845.85;   529.24;   332.61;   209.95;   133.09;    84.73;    54.16) |
| 50  | 4916.63 (2989.50;  1826.67;  1121.52;   691.83;   428.75;   266.92;   166.91;   104.83;    66.12;    41.88) |
| 51  | 5253.32 (3162.60;  1913.48;  1163.42;   710.78;   436.29;   269.05;   166.67;   103.71;    64.82;    40.68) |
| 52  | 4971.45 (2963.27;  1775.31;  1068.93;   646.77;   393.22;   240.20;   147.41;    90.88;    56.27;    35.00) |
| 53  | 4957.13 (2925.48;  1735.49;  1034.80;   620.10;   373.42;   225.95;   137.37;    83.90;    51.48;    31.73) |
| 54  | 6368.60 (3721.26;  2185.92;  1290.73;   766.03;   456.90;   273.86;   164.94;    99.81;    60.68;    37.05) |
| 55  | 4774.23 (2762.03;  1606.55;   939.41;   552.17;   326.21;   193.68;   115.56;    69.28;    41.73;    25.25) |
| 56  | 6516.47 (3732.63;  2149.82;  1244.88;   724.68;   424.04;   249.39;   147.41;    87.56;    52.26;    31.33) |
| 57  | 3451.25 (1957.30;  1116.26;   640.11;   369.04;   213.89;   124.61;    72.96;    42.94;    25.39;    15.09) |
| 58  | 5584.61 (3135.84;  1770.86;  1005.62;   574.20;   329.62;   190.22;   110.34;    64.33;    37.69;    22.19) |
| 59  | 5123.85 (2848.63;  1592.89;   895.78;   506.56;   288.02;   164.65;    94.61;    54.65;    31.73;    18.51) |
| 60  | 5215.94 (2871.11;  1589.73;   885.32;   495.83;   279.24;   158.12;    90.01;    51.51;    29.63;    17.13) |
| 61  | 5379.64 (2931.90;  1607.47;   886.51;   491.72;   274.29;   153.85;    86.76;    49.19;    28.04;    16.06) |
| 62  | 4497.68 (2426.96;  1317.58;   719.58;   395.29;   218.40;   121.35;    67.79;    38.08;    21.51;    12.21) |
| 63  | 4666.79 (2493.29;  1340.32;   724.89;   394.38;   215.82;   118.78;    65.74;    36.59;    20.47;    11.52) |
| 64  | 3981.42 (2106.06;  1121.06;   600.42;   323.52;   175.36;    95.60;    52.42;    28.90;    16.02;     8.93) |
| 65  | 3928.21 (2057.34;  1084.38;   575.14;   306.92;   164.77;    88.98;    48.33;    26.40;    14.50;     8.01) |
| 66  | 5303.53 (2750.14;  1435.34;   753.89;   398.44;   211.87;   113.34;    60.99;    33.01;    17.96;     9.83) |
| 67  | 5448.21 (2797.19;  1445.58;   751.90;   393.57;   207.29;   109.84;    58.55;    31.40;    16.93;     9.18) |
| 68  | 5053.00 (2568.60;  1314.43;   677.05;   350.98;   183.10;    96.11;    50.75;    26.96;    14.41;     7.74) |
| 69  | 5922.27 (2980.67;  1510.35;   770.41;   395.54;   204.37;   106.26;    55.59;    29.26;    15.49;     8.25) |
| 70  | 7050.08 (3513.16;  1762.72;   890.41;   452.75;   231.71;   119.34;    61.85;    32.25;    16.92;     8.93) |
| 71  | 4508.97 (2224.64;  1105.26;   552.88;   278.43;   141.14;    72.00;    36.97;    19.10;     9.93;     5.19) |
| 72  | 2690.83 (1314.46;   646.66;   320.34;   159.77;    80.22;    40.54;    20.62;    10.55;     5.43;     2.82) |
| 73  | 6005.74 (2904.73;  1414.99;   694.14;   342.87;   170.51;    85.36;    43.01;    21.81;    11.13;     5.71) |
| 74  | 4290.80 (2054.74;   991.12;   481.49;   235.54;   116.02;    57.53;    28.72;    14.43;     7.29;     3.71) |
| 75  | 4311.99 (2044.44;   976.48;   469.77;   227.60;   111.04;    54.54;    26.97;    13.42;     6.72;     3.39) |
| 76  | 6025.57 (2828.61;  1337.78;   637.34;   305.82;   147.78;    71.90;    35.22;    17.37;     8.62;     4.31) |
| 77  | 4715.23 (2191.58;  1026.34;   484.21;   230.11;   110.14;    53.08;    25.76;    12.59;     6.19;     3.06) |
| 78  | 3779.28 (1739.17;   806.48;   376.80;   177.34;    84.07;    40.14;    19.30;     9.34;     4.55;     2.23) |
| 79  | 5181.30 (2360.75;  1083.99;   501.53;   233.78;   109.77;    51.91;    24.72;    11.86;     5.72;     2.78) |
| 80  | 4861.11 (2192.93;   997.06;   456.83;   210.90;    98.08;    45.95;    21.68;    10.30;     4.93;     2.37) |
| 81  | 5005.76 (2235.83;  1006.60;   456.73;   208.82;    96.19;    44.64;    20.86;     9.82;     4.66;     2.22) |
| 82  | 5385.28 (2381.53;  1061.68;   477.04;   216.01;    98.56;    45.30;    20.98;     9.78;     4.59;     2.17) |
| 83  | 4629.34 (2026.96;   894.76;   398.13;   178.55;    80.69;    36.74;    16.85;     7.79;     3.62;     1.70) |
| 84  | 5644.38 (2446.92;  1069.55;   471.29;   209.32;    93.69;    42.26;    19.20;     8.79;     4.05;     1.88) |
| 85  | 4779.51 (2051.48;   887.91;   387.45;   170.43;    75.56;    33.76;    15.20;     6.89;     3.15;     1.45) |
| 86  | 5331.78 (2265.87;   971.09;   419.63;   182.81;    80.28;    35.53;    15.84;     7.12;     3.22;     1.47) |
| 87  | 6096.84 (2565.34;  1088.65;   465.87;   201.00;    87.43;    38.33;    16.93;     7.54;     3.38;     1.53) |
| 88  | 5435.18 (2264.30;   951.48;   403.22;   172.30;    74.23;    32.23;    14.11;     6.22;     2.76;     1.24) |
| 89  | 4674.07 (1927.94;   802.19;   336.65;   142.47;    60.79;    26.15;    11.34;     4.95;     2.18;     0.97) |
| 90  | 6148.81 (2511.12;  1034.61;   429.97;   180.21;    76.16;    32.45;    13.94;     6.03;     2.63;     1.16) |
| 91  | 5993.50 (2423.46;   988.70;   406.91;   168.91;    70.71;    29.84;    12.70;     5.45;     2.35;     1.03) |
| 92  | 5548.40 (2221.27;   897.33;   365.72;   150.35;    62.34;    26.06;    10.99;     4.67;     2.00;     0.86) |
| 93  | 5238.73 (2076.53;   830.63;   335.25;   136.50;    56.06;    23.22;     9.69;     4.08;     1.73;     0.74) |
| 94  | 4372.09 (1715.85;   679.63;   271.64;   109.54;    44.55;    18.28;     7.56;     3.15;     1.33;     0.56) |
| 95  | 6360.65 (2471.56;   969.36;   383.68;   153.23;    61.73;    25.09;    10.28;     4.25;     1.77;     0.74) |
| 96  | 4399.74 (1692.68;   657.37;   257.66;   101.91;    40.67;    16.37;     6.65;     2.72;     1.12;     0.47) |
| 97  | 7187.33 (2737.75;  1052.81;   408.66;   160.08;    63.27;    25.23;    10.15;     4.12;     1.68;     0.69) |
| 98  | 6532.61 (2463.72;   938.14;   360.61;   139.90;    54.77;    21.63;     8.62;     3.46;     1.40;     0.57) |
| 99  | 4764.30 (1779.03;   670.78;   255.34;    98.11;    38.04;    14.88;     5.87;     2.34;     0.94;     0.38) |
| 100 | 3973.58 (1469.08;   548.48;   206.76;    78.68;    30.22;    11.71;     4.58;     1.81;     0.72;     0.29) |
```
#### Fluxos de caixa somados
```python
|  Mês  |             Somatório (VPL 1%; VPL 2%; VPL 3%; VPL 4%; VPL 5%; VPL 6%; VPL 7%; VPL 8%; VPL 9%; VPL 10%)             |
|:-----:|:-------------------------------------------------------------------------------------------------------------------:|
| Todos | 509040.59 (319763.46; 218247.65; 159937.71; 124098.40; 100634.71; 84389.03; 72590.91; 63675.48; 56714.70; 51132.44) |
```
#
